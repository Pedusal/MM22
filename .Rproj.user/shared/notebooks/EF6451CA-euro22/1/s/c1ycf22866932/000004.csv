"0","library(dplyr)"
"0","library(knitr)"
"0","################### Hae oikea rivi ################"
"0",""
"0","oikearivi <- read_excel(""data/11oikearivi.xlsx"")"
"2","New names:
* `` -> ...2
* `` -> ...3
* `` -> ...4
* `` -> ...5
* `` -> ...6
* ...
"
"0","###### Muokkaaa  sopivaksi #############"
"0",""
"0","oikearivi <- oikearivi %>%   "
"0","  filter(!is.na(oikearivi[,6]),"
"0","         !is.na(oikearivi[,8])"
"0","  )#%>%"
"0","  #rename(X__2 = Kotii,"
"0","   #      X__4 = viieras"
"0","  #) "
"0",""
"0","############ Aseta tarkistussarjat ##################"
"0",""
"0","koti <- oikearivi$...6"
"0","vieras <- oikearivi$...8"
"0","koti <- as.numeric(koti)"
"0",""
"0","merkki <- c(1:length(koti))"
"0","merkki[1:length(koti)] <- NA"
"0",""
"0","x <- c(1:length(koti))"
"0","for (i in x) {"
"0","  if (koti[i]>vieras[i]){"
"0","    merkki[i] <- 1"
"0","  } else if (koti[i] == vieras[i]) {"
"0","    merkki[i] <- 2"
"0","  } else if (koti[i]<vieras[i]) {"
"0","    merkki[i] <- 3"
"0","  }"
"0","}"
"0",""
"0","################# Luo Pistetaulu ###################"
"0",""
"0","pelit <- c(1:50)"
"0","pelit[1] <- c(""Veikkaaja"")"
"0","pelit[2] <- c(""Yhteensa"")"
"0","for (i in x) {"
"0","  pelit[i+2] <- c(paste(oikearivi$...3[i], ""-"", oikearivi$...5[i]))"
"0","}"
"0",""
"0","pistetaulu <- matrix(NA,10,50)"
"0","colnames(pistetaulu) <- c(pelit)"
"0","pistetaulu <- as.data.frame(pistetaulu)"
"0",""
"0","################### Veikkausten tarkistus ja lisays pistetauluun #######"
"0",""
"0","y <- c(2:length(veikkaukset))"
"0",""
"0",""
"0","for (u in y) {"
"0","  tarkistettava <- data.frame(veikkaukset[u])"
"0","  pistetaulu[u-1, 1] <- tarkistettava[1,5]  ## asetetaan veikkaajan nimi "
"0","  "
"0","  tarkistettava <- tarkistettava %>% "
"0","    filter(!is.na(...6),"
"0","         !is.na(...8)"
"0","  )"
"0","  "
"0","  koti1 <- tarkistettava$...6"
"0","  vieras1 <- tarkistettava$...8"
"0","  koti1 <- as.numeric(koti1)"
"0",""
"0","  merkki1 <- c(1:length(koti1))"
"0","  merkki1[1:length(koti1)] <- NA"
"0",""
"0","  for (i in x) {"
"0",""
"0","    if(koti1[i]>vieras1[i]){"
"0","      merkki1[i] <- 1"
"0",""
"0","      } else if (koti1[i] == vieras1[i]) {"
"0","  "
"0","        merkki1[i] <- 2"
"0",""
"0","      } else if (koti1[i]<vieras1[i]) {"
"0","  "
"0","        merkki1[i] <- 3"
"0",""
"0","      }"
"0","    }"
"0",""
"0","  x <- c(1:length(koti))"
"0","  for (i in x) {"
"0","    if(koti[i] == koti1[i] & vieras[i] == vieras1[i]) {"
"0","       pistetaulu[u-1, i+2] <- c(3)"
"0","       #} else if (merkki[i] == merkki1[i] "
"0","        #     & (koti[i] == koti1 [i] | vieras == vieras1[i])){"
"0","         # pistetaulu[u-1, i+1] <- c(2)"
"0","       } else if (merkki[i] == merkki1[i]) {"
"0","          pistetaulu[u-1, i+2] <- c(1)"
"0","       } else {"
"0","          pistetaulu[u-1, i+2] <- c(0)"
"0","       }"
"0","  }"
"0","  "
"0",""
"0","}"
"2","NAs introduced by coercion"
"2","NAs introduced by coercion"
"0","pistetaulu$Yhteensa <- apply(pistetaulu[1:10, 1:length(koti)+2], 1, sum)"
"0","sort(pistetaulu$Yhteensa)"
"1","[1]"
"1"," 3"
"1"," 4"
"1"," 4"
"1"," 4"
"1"," 7"
"1"," 8"
"1","
"
"0","# #wb <- createWorkbook(type = ""xlsx"")"
"0","# library(xlsx)"
"0","# write.xlsx(mydata, ""c:/mydata.xlsx"")"
"0","# "
"0","# taulu <- matrix(NA,10,50)"
"0","# y <- c(2:10)"
"0","# x <- c(1:50)"
"0","# "
"0","# for (u in y) {"
"0","#   "
"0","#   for (i in x) {"
"0","#     taulu[u,i] <- u"
"0","#   }"
"0","# }"
"0",""
